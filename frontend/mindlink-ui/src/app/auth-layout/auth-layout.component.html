<!-- auth-layout.component.html -->
<div class="layout-wrapper">
  <!-- Navbar -->
  <nav class="navbar">
    <!-- Logo & Brand -->
    <div class="navbar-start">
      <button class="mobile-menu-toggle" (click)="toggleMenu()" [class.active]="menuOpen">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <div class="brand">
        <div class="logo-container">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 6v6l4 2"></path>
          </svg>
        </div>
        <span class="brand-name">MindLink</span>
      </div>
    </div>

    <!-- User Menu -->
    <div class="navbar-end">
      <div class="user-menu" *ngIf="currentUser">
        <button class="user-avatar" (click)="toggleMenu()">
          <div class="avatar">
            {{ initials }}
          </div>
          <span class="username">{{ currentUser.username }}</span>
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" *ngIf="menuOpen" [@slideDown]>
          <div class="menu-header">
            <div class="user-info">
              <div class="avatar-large">{{ initials }}</div>
              <div class="user-details">
                <p class="user-name">{{ currentUser.username }}</p>
                <p class="user-email" *ngIf="currentUser.email">
                  {{ currentUser.email }}
                </p>
              </div>
            </div>
          </div>

          <div class="menu-divider"></div>

          <div class="menu-items">
            <button class="menu-item" (click)="navigateTo('/graph')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="19" cy="12" r="1"></circle>
                <circle cx="5" cy="12" r="1"></circle>
                <path d="M12 12v5"></path>
                <path d="M12 7V5"></path>
              </svg>
              <span>Knowledge Graph</span>
            </button>

            <button class="menu-item" (click)="navigateTo('/settings')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m5.08 5.08l4.24 4.24M1 12h6m6 0h6M4.22 19.78l4.24-4.24m5.08-5.08l4.24-4.24"></path>
              </svg>
              <span>Impostazioni</span>
            </button>
          </div>

          <div class="menu-divider"></div>

          <button
            class="logout-button"
            (click)="logout()"
            [disabled]="isLoading"
          >
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M10 3H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h4"></path>
              <polyline points="17 16 21 12 17 8"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            <span *ngIf="!isLoading">Logout</span>
            <span *ngIf="isLoading" class="spinner-small"></span>
          </button>
        </div>

        <!-- Menu Overlay (Mobile) -->
        <div
          class="menu-overlay"
          *ngIf="menuOpen"
          (click)="closeMenu()"
        ></div>
      </div>

      <!-- Not Logged In State -->
      <button *ngIf="!currentUser" class="login-button" (click)="navigateTo('/auth')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
          <polyline points="10 17 15 12 10 7"></polyline>
          <line x1="15" y1="12" x2="3" y2="12"></line>
        </svg>
        Login
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="layout-content">
    <div class="content-inner">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
